{% extends 'website/base.html' %}
{% load static %}

{% block title %}{{ site_settings.site_title|default:"AKILIMO Nigeria Association" }} - {{ site_settings.site_tagline|default:"Advancing Cassava Production Through Innovation" }}{% endblock %}

{% block extra_css %}
<style>
    /* Hero Slider Custom Styles */
    #heroCarousel .carousel-item {
        transition: transform 0.8s ease-in-out, opacity 0.8s ease-in-out;
    }

    #heroCarousel .carousel-fade .carousel-item {
        opacity: 0;
        transition-property: opacity;
        transform: none;
    }

    #heroCarousel .carousel-fade .carousel-item.active {
        opacity: 1;
    }

    #heroCarousel .carousel-control-prev,
    #heroCarousel .carousel-control-next {
        width: 60px;
        height: 60px;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        backdrop-filter: blur(10px);
        opacity: 0;
        transition: all 0.3s ease;
    }

    #heroCarousel:hover .carousel-control-prev,
    #heroCarousel:hover .carousel-control-next {
        opacity: 1;
    }

    #heroCarousel .carousel-control-prev {
        left: 30px;
    }

    #heroCarousel .carousel-control-next {
        right: 30px;
    }

    #heroCarousel .carousel-control-prev:hover,
    #heroCarousel .carousel-control-next:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-50%) scale(1.1);
    }

    #heroCarousel .carousel-indicators {
        margin-bottom: 2rem;
    }

    #heroCarousel .carousel-indicators button {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        margin: 0 6px;
        border: 2px solid rgba(255, 255, 255, 0.8);
        background-color: transparent;
        transition: all 0.3s ease;
    }

    #heroCarousel .carousel-indicators button.active {
        background-color: white;
        width: 40px;
        border-radius: 6px;
    }

    /* Bounce Animation for Scroll Indicator */
    .animate-bounce {
        animation: bounce 2s infinite;
    }

    @keyframes bounce {
        0%, 20%, 50%, 80%, 100% {
            transform: translateY(0);
        }
        40% {
            transform: translateY(-10px);
        }
        60% {
            transform: translateY(-5px);
        }
    }

    /* Responsive Text Sizes */
    @media (max-width: 768px) {
        .hero-title {
            font-size: 2.5rem !important;
        }

        .hero-subtitle {
            font-size: 1.3rem !important;
        }

        .lead {
            font-size: 1rem !important;
        }

        #heroCarousel .carousel-control-prev,
        #heroCarousel .carousel-control-next {
            width: 40px;
            height: 40px;
        }

        #heroCarousel .carousel-control-prev {
            left: 10px;
        }

        #heroCarousel .carousel-control-next {
            right: 10px;
        }
    }

    /* Smooth scroll */
    html {
        scroll-behavior: smooth;
    }
</style>
{% endblock %}

{% block content %}
    <!-- Hero Section with Slider -->
    <section class="hero-section position-relative" style="min-height: 100vh; overflow: hidden;">
        <!-- Hero Slider -->
        <div id="heroCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel" data-bs-interval="5000">
            <div class="carousel-inner">
                {% if hero_slides %}
                    {% for slide in hero_slides %}
                        <div class="carousel-item {% if forloop.first %}active{% endif %}" style="min-height: 100vh; background: {{ slide.background_color }}; display: flex; align-items: center;">
                            {% if slide.background_image %}
                                <div class="position-absolute top-0 start-0 w-100 h-100" style="background-image: url('{{ slide.background_image.url }}'); background-size: cover; background-position: center; opacity: 0.3;"></div>
                            {% endif %}
                            <div class="container" style="position: relative; z-index: 1;">
                                <div class="row justify-content-center text-center">
                                    <div class="col-lg-10">
                                        <h1 class="hero-title mb-4 text-white" data-aos="fade-up" style="font-size: 4rem; font-weight: 700; line-height: 1.2;">
                                            {{ slide.title }}
                                        </h1>
                                        {% if slide.subtitle %}
                                            <h2 class="hero-subtitle mb-5 text-white" data-aos="fade-up" data-aos-delay="100" style="font-size: 1.8rem; font-weight: 300; opacity: 0.95;">
                                                {{ slide.subtitle }}
                                            </h2>
                                        {% endif %}
                                        {% if slide.description %}
                                            <p class="lead mb-5 text-white" data-aos="fade-up" data-aos-delay="200" style="font-size: 1.3rem; max-width: 800px; margin: 0 auto; opacity: 0.9;">
                                                {{ slide.description }}
                                            </p>
                                        {% endif %}
                                        <div class="d-flex justify-content-center gap-3 flex-wrap" data-aos="fade-up" data-aos-delay="300">
                                            {% if slide.button_1_text %}
                                                <a href="{{ slide.button_1_url }}" class="btn btn-light btn-lg px-5 py-3" style="border-radius: 50px; font-weight: 600;">
                                                    {% if slide.button_1_icon %}<i class="{{ slide.button_1_icon }} me-2"></i>{% endif %}{{ slide.button_1_text }}
                                                </a>
                                            {% endif %}
                                            {% if slide.button_2_text %}
                                                <a href="{{ slide.button_2_url }}" class="btn btn-outline-light btn-lg px-5 py-3" style="border-radius: 50px; border-width: 2px;">
                                                    {% if slide.button_2_icon %}<i class="{{ slide.button_2_icon }} me-2"></i>{% endif %}{{ slide.button_2_text %}
                                                </a>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <!-- Default slide if no CMS slides exist -->
                    <div class="carousel-item active" style="min-height: 100vh; background: linear-gradient(135deg, #1C4523 0%, #4CAF50 100%); display: flex; align-items: center;">
                        <div class="container">
                            <div class="row justify-content-center text-center">
                                <div class="col-lg-10">
                                    <h1 class="hero-title mb-4 text-white" data-aos="fade-up" style="font-size: 4rem; font-weight: 700; line-height: 1.2;">
                                        AKILIMO Nigeria Association
                                    </h1>
                                    <h2 class="hero-subtitle mb-5 text-white" data-aos="fade-up" data-aos-delay="100" style="font-size: 1.8rem; font-weight: 300; opacity: 0.95;">
                                        Promoting Evidence-Based Agronomic Advisory Services
                                    </h2>
                                    <p class="lead mb-5 text-white" data-aos="fade-up" data-aos-delay="200" style="font-size: 1.3rem; max-width: 800px; margin: 0 auto; opacity: 0.9;">
                                        Advancing AKILIMO tools to provide site-specific recommendations that optimize productivity and profits for smallholder farmers
                                    </p>
                                    <div class="d-flex justify-content-center gap-3 flex-wrap" data-aos="fade-up" data-aos-delay="300">
                                        <a href="{% url 'website:register_redirect' %}" class="btn btn-light btn-lg px-5 py-3" style="border-radius: 50px; font-weight: 600;">
                                            <i class="bi bi-person-plus me-2"></i>Join ANA
                                        </a>
                                        <a href="{% url 'website:about' %}" class="btn btn-outline-light btn-lg px-5 py-3" style="border-radius: 50px; border-width: 2px;">
                                            <i class="bi bi-info-circle me-2"></i>Learn More
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>

            <!-- Slider Controls -->
            <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>

            <!-- Slider Indicators -->
            {% if hero_slides %}
                <div class="carousel-indicators" style="bottom: 50px;">
                    {% for slide in hero_slides %}
                        <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="{{ forloop.counter0 }}" {% if forloop.first %}class="active" aria-current="true"{% endif %} aria-label="Slide {{ forloop.counter }}"></button>
                    {% endfor %}
                </div>
            {% endif %}
        </div>

        <!-- Scroll Indicator -->
        <div class="position-absolute bottom-0 start-50 translate-middle-x mb-5" style="z-index: 10;">
            <div class="text-center">
                <a href="#mission-section" class="text-decoration-none">
                    <div class="text-white mb-2 animate-bounce">
                        <i class="bi bi-chevron-down fs-3"></i>
                    </div>
                    <small class="text-white" style="opacity: 0.8;">Scroll to explore</small>
                </a>
            </div>
        </div>
    </section>

    <!-- Mission & Vision Section -->
    <section id="mission-section" class="section-padding bg-light-green">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up">Mission & Vision</h2>
            <div class="row">
                {% if mission_vision %}
                    <div class="col-lg-6 mb-4" data-aos="fade-up" data-aos-delay="100">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body text-center p-4">
                                <div class="mb-3">
                                    <i class="{{ mission_vision.mission_icon|default:'bi-crosshair' }} display-4" style="color: var(--primary-accent);"></i>
                                </div>
                                <h4 class="card-title mb-3" style="color: var(--primary-accent);">{{ mission_vision.mission_title }}</h4>
                                <p class="card-text">{{ mission_vision.mission_content }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 mb-4" data-aos="fade-up" data-aos-delay="200">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body text-center p-4">
                                <div class="mb-3">
                                    <i class="{{ mission_vision.vision_icon|default:'bi-lightbulb' }} display-4" style="color: var(--primary-accent);"></i>
                                </div>
                                <h4 class="card-title mb-3" style="color: var(--primary-accent);">{{ mission_vision.vision_title }}</h4>
                                <p class="card-text">{{ mission_vision.vision_content }}</p>
                            </div>
                        </div>
                    </div>
                {% else %}
                    <!-- Default mission & vision if no CMS content exists -->
                    <div class="col-lg-6 mb-4" data-aos="fade-up" data-aos-delay="100">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body text-center p-4">
                                <div class="mb-3">
                                    <i class="bi bi-crosshair display-4" style="color: var(--primary-accent);"></i>
                                </div>
                                <h4 class="card-title mb-3" style="color: var(--primary-accent);">Our Mission</h4>
                                <p class="card-text">To promote and scale the use of AKILIMO's evidence-based agronomic advisory services across Nigeria, empowering smallholder farmers with site-specific recommendations that optimize productivity and profitability.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 mb-4" data-aos="fade-up" data-aos-delay="200">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body text-center p-4">
                                <div class="mb-3">
                                    <i class="bi bi-lightbulb display-4" style="color: var(--primary-accent);"></i>
                                </div>
                                <h4 class="card-title mb-3" style="color: var(--primary-accent);">Our Vision</h4>
                                <p class="card-text">A thriving agricultural sector in Nigeria where every smallholder farmer has access to data-driven decision support tools, leading to improved livelihoods, sustainable practices, and enhanced food security.</p>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </section>

    <!-- Statistics Section -->
    <section class="section-padding">
        <div class="container">
            <div class="row text-center">
                {% if homepage_statistics %}
                    {% for stat in homepage_statistics %}
                        <div class="col-lg-3 col-md-6 mb-4" data-aos="fade-up" data-aos-delay="{{ forloop.counter|add:100 }}">
                            <div class="stat-card">
                                {% if stat.icon %}
                                    <div class="mb-3">
                                        <i class="{{ stat.icon }} display-4" style="color: var(--primary-accent);"></i>
                                    </div>
                                {% endif %}
                                <div class="stat-number">{{ stat.value }}</div>
                                <div class="stat-label">{{ stat.label }}</div>
                                {% if stat.description %}
                                    <small class="text-muted">{{ stat.description }}</small>
                                {% endif %}
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <!-- Default statistics if no CMS statistics -->
                    <div class="col-lg-3 col-md-6 mb-4" data-aos="fade-up" data-aos-delay="100">
                        <div class="stat-card">
                            <div class="stat-number">500+</div>
                            <div class="stat-label">Active Farmers</div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-4" data-aos="fade-up" data-aos-delay="200">
                        <div class="stat-card">
                            <div class="stat-number">50+</div>
                            <div class="stat-label">Partner Organizations</div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-4" data-aos="fade-up" data-aos-delay="300">
                        <div class="stat-card">
                            <div class="stat-number">25</div>
                            <div class="stat-label">States Covered</div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-4" data-aos="fade-up" data-aos-delay="400">
                        <div class="stat-card">
                            <div class="stat-number">100k+</div>
                            <div class="stat-label">Hectares Improved</div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </section>

    <!-- About Section -->
    {% if homepage_sections %}
        {% for section in homepage_sections %}
            {% if section.section_type == 'about' %}
                <section class="section-padding">
                    <div class="container">
                        <div class="row align-items-center">
                            <div class="col-lg-6 mb-4 mb-lg-0" data-aos="fade-right">
                                {% if section.image %}
                                    <img src="{{ section.image.url }}" alt="{{ section.title }}" class="img-fluid rounded-3 shadow">
                                {% else %}
                                    <div class="bg-light-green rounded-3 p-5 text-center">
                                        <i class="bi bi-people display-1 text-success"></i>
                                        <h4 class="mt-3">Our Community</h4>
                                    </div>
                                {% endif %}
                            </div>
                            <div class="col-lg-6" data-aos="fade-left">
                                <h2 class="section-title text-start mb-4">{{ section.title|default:"About AKILIMO Nigeria" }}</h2>
                                <p class="lead">{{ section.subtitle|default:"Empowering farmers with technology and knowledge" }}</p>
                                <div class="content">
                                    {{ section.content|linebreaks|default:"We are dedicated to transforming cassava production in Nigeria through innovative agricultural practices, technology adoption, and sustainable farming solutions. Our programs connect farmers with resources, training, and markets to improve their livelihoods." }}
                                </div>
                                {% if section.button_text and section.button_url %}
                                    <a href="{{ section.button_url }}" class="btn btn-primary mt-3">
                                        {{ section.button_text }}
                                        <i class="bi bi-arrow-right ms-2"></i>
                                    </a>
                                {% else %}
                                    <a href="{% url 'website:about' %}" class="btn btn-primary mt-3">
                                        Learn More About Us
                                        <i class="bi bi-arrow-right ms-2"></i>
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </section>
            {% endif %}
        {% endfor %}
    {% endif %}

    <!-- Aims & Objectives Section -->
    <section class="section-padding bg-light-green">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up">AKILIMO's Four Operational Pillars</h2>
            <p class="section-subtitle" data-aos="fade-up" data-aos-delay="100">
                Building on AKILIMO's proven framework to advance agricultural innovation in Nigeria
            </p>

            <div class="row justify-content-center">
                {% if operational_pillars %}
                    {% for pillar in operational_pillars %}
                        <div class="col-lg-6 col-md-6 mb-4" data-aos="fade-up" data-aos-delay="{{ forloop.counter|add:100 }}">
                            <div class="card h-100 border-0 shadow-sm">
                                <div class="card-body p-4">
                                    <div class="mb-3">
                                        <i class="{{ pillar.icon }} display-4" style="color: var(--primary-accent);"></i>
                                    </div>
                                    <h5 class="card-title">{{ pillar.title }}</h5>
                                    <p class="card-text">{{ pillar.description }}</p>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <!-- Default pillars if no CMS content exists -->
                    <div class="col-lg-6 col-md-6 mb-4" data-aos="fade-up" data-aos-delay="100">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body p-4">
                                <div class="mb-3">
                                    <i class="bi bi-clipboard-data display-4" style="color: var(--primary-accent);"></i>
                                </div>
                                <h5 class="card-title">Advisory Service</h5>
                                <p class="card-text">Providing customized decision support for farm operations through evidence-based, site-specific recommendations that account for major production limiting factors using advanced data analytics.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6 mb-4" data-aos="fade-up" data-aos-delay="200">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body p-4">
                                <div class="mb-3">
                                    <i class="bi bi-people-fill display-4" style="color: var(--primary-accent);"></i>
                                </div>
                                <h5 class="card-title">Research Community</h5>
                                <p class="card-text">Collaborating with farmers, researchers, and global organizations on predictive modeling and agricultural innovation to continuously improve recommendation algorithms.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6 mb-4" data-aos="fade-up" data-aos-delay="300">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body p-4">
                                <div class="mb-3">
                                    <i class="bi bi-handshake display-4" style="color: var(--primary-accent);"></i>
                                </div>
                                <h5 class="card-title">Strategic Partnership</h5>
                                <p class="card-text">Building win-win scenarios that maximize profitability across value chain networks, connecting farmers with markets, inputs, and financial services through strategic alliances.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6 mb-4" data-aos="fade-up" data-aos-delay="400">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body p-4">
                                <div class="mb-3">
                                    <i class="bi bi-mortarboard display-4" style="color: var(--primary-accent);"></i>
                                </div>
                                <h5 class="card-title">Training Platform</h5>
                                <p class="card-text">Developing comprehensive training materials and capacity building programs for extension agents, aggregators, and last-mile delivery partners to effectively disseminate AKILIMO recommendations.</p>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </section>

    <!-- Featured Partners -->
    {% if featured_partners %}
        <section class="section-padding">
            <div class="container">
                <h2 class="section-title" data-aos="fade-up">Our Partners</h2>
                <p class="section-subtitle" data-aos="fade-up" data-aos-delay="100">
                    Working together to transform agriculture in Nigeria
                </p>
                
                <div class="row">
                    {% for partner in featured_partners %}
                        <div class="col-lg-2 col-md-3 col-sm-4 col-6 mb-4" data-aos="fade-up" data-aos-delay="{{ forloop.counter|add:100 }}">
                            <div class="card h-100 text-center p-3 partner-card">
                                {% if partner.logo %}
                                    <div class="partner-logo mb-3">
                                        {% if partner.website %}
                                            <a href="{{ partner.website }}" target="_blank" rel="noopener">
                                                <img src="{{ partner.logo.url }}" alt="{{ partner.name }}" class="img-fluid" style="max-height: 80px; object-fit: contain; transition: transform 0.3s ease;">
                                            </a>
                                        {% else %}
                                            <img src="{{ partner.logo.url }}" alt="{{ partner.name }}" class="img-fluid" style="max-height: 80px; object-fit: contain;">
                                        {% endif %}
                                    </div>
                                {% else %}
                                    <div class="text-center p-3">
                                        <i class="bi bi-building display-6 text-muted"></i>
                                    </div>
                                {% endif %}
                                <div class="card-body p-2">
                                    <small class="text-muted">{{ partner.name }}</small>
                                    {% if partner.website %}
                                        <div class="mt-2">
                                            <a href="{{ partner.website }}" target="_blank" rel="noopener" class="btn btn-outline-primary btn-sm">
                                                <i class="bi bi-globe me-1"></i>
                                            </a>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                
                <div class="text-center mt-4" data-aos="fade-up">
                    <a href="{% url 'website:partners' %}" class="btn btn-outline-primary">
                        View All Partners
                        <i class="bi bi-arrow-right ms-2"></i>
                    </a>
                </div>
            </div>
        </section>
    {% endif %}

    <!-- Testimonials -->
    {% if featured_testimonials %}
        <section class="section-padding bg-light-green">
            <div class="container">
                <h2 class="section-title" data-aos="fade-up">What Our Farmers Say</h2>
                <p class="section-subtitle" data-aos="fade-up" data-aos-delay="100">
                    Real stories from farmers who have benefited from our programs
                </p>
                
                <div class="row">
                    {% for testimonial in featured_testimonials %}
                        <div class="col-lg-4 mb-4" data-aos="fade-up" data-aos-delay="{{ forloop.counter|add:100 }}">
                            <div class="card h-100 border-0 shadow-lg position-relative" style="border-radius: 1.5rem;">
                                <!-- Quote Icon -->
                                <div class="position-absolute top-0 start-0 translate-middle">
                                    <div class="bg-success text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
                                        <i class="bi bi-quote fs-4"></i>
                                    </div>
                                </div>
                                
                                <div class="card-body p-4 pt-5">
                                    <div class="testimonial-content mb-4">
                                        <p class="font-italic">"{{ testimonial.content }}"</p>
                                    </div>
                                    
                                    <!-- Rating -->
                                    <div class="text-warning mb-3">
                                        {% for i in "12345"|slice:testimonial.rating %}
                                            <i class="bi bi-star-fill"></i>
                                        {% endfor %}
                                        {% for i in "12345"|slice:":"|slice:testimonial.rating %}
                                            <i class="bi bi-star text-muted"></i>
                                        {% endfor %}
                                    </div>
                                    
                                    <div class="testimonial-author d-flex align-items-center">
                                        {% if testimonial.photo %}
                                            <img src="{{ testimonial.photo.url }}" alt="{{ testimonial.name }}" class="rounded-circle me-3" style="width: 60px; height: 60px; object-fit: cover;">
                                        {% else %}
                                            <div class="bg-success text-white rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 60px; height: 60px;">
                                                <i class="bi bi-person fs-4"></i>
                                            </div>
                                        {% endif %}
                                        <div>
                                            <h6 class="mb-1" style="color: var(--primary-accent);">{{ testimonial.name }}</h6>
                                            <small class="text-muted">
                                                {% if testimonial.position %}{{ testimonial.position }}{% endif %}
                                                {% if testimonial.organization %}
                                                    {% if testimonial.position %}, {% endif %}{{ testimonial.organization }}
                                                {% endif %}
                                            </small>
                                            <div class="mt-1">
                                                <span class="badge bg-light text-success">{{ testimonial.get_testimonial_type_display }}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                
                <div class="text-center mt-4" data-aos="fade-up">
                    <a href="#" class="btn btn-success">
                        View All Testimonials
                        <i class="bi bi-arrow-right ms-2"></i>
                    </a>
                </div>
            </div>
        </section>
    {% endif %}

    <!-- Latest News -->
    {% if featured_news %}
        <section class="section-padding">
            <div class="container">
                <h2 class="section-title" data-aos="fade-up">Latest News & Updates</h2>
                <p class="section-subtitle" data-aos="fade-up" data-aos-delay="100">
                    Stay informed with the latest developments in our programs
                </p>
                
                <div class="row">
                    {% for article in featured_news %}
                        <div class="col-lg-4 mb-4" data-aos="fade-up" data-aos-delay="{{ forloop.counter|add:100 }}">
                            <div class="card h-100">
                                {% if article.featured_image %}
                                    <img src="{{ article.featured_image.url }}" class="card-img-top" alt="{{ article.title }}" style="height: 200px; object-fit: cover;">
                                {% else %}
                                    <div class="card-img-top bg-light-green d-flex align-items-center justify-content-center" style="height: 200px;">
                                        <i class="bi bi-newspaper display-4 text-success"></i>
                                    </div>
                                {% endif %}
                                <div class="card-body d-flex flex-column">
                                    <div class="mb-2">
                                        <span class="badge" style="background-color: var(--primary-accent);">{{ article.get_category_display }}</span>
                                        <small class="text-muted ms-2">{{ article.published_date|date:"M d, Y" }}</small>
                                    </div>
                                    <h5 class="card-title">{{ article.title }}</h5>
                                    <p class="card-text flex-grow-1">{{ article.excerpt }}</p>
                                    <a href="{{ article.get_absolute_url }}" class="btn btn-outline-primary mt-auto">
                                        Read More
                                        <i class="bi bi-arrow-right ms-2"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                
                <div class="text-center mt-4" data-aos="fade-up">
                    <a href="{% url 'website:news_list' %}" class="btn btn-primary">
                        View All News
                        <i class="bi bi-arrow-right ms-2"></i>
                    </a>
                </div>
            </div>
        </section>
    {% endif %}

    <!-- Call to Action -->
    {% if cta %}
        <section class="section-padding text-white" style="{{ cta.background_style }}">
            <div class="container text-center">
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <h2 class="display-5 fw-bold mb-4" data-aos="fade-up">{{ cta.title }}</h2>
                        <p class="lead mb-4" data-aos="fade-up" data-aos-delay="100">
                            {{ cta.description }}
                        </p>
                        <div class="d-flex flex-wrap justify-content-center gap-3" data-aos="fade-up" data-aos-delay="200">
                            <a href="{{ cta.button_1_url }}" class="btn btn-light btn-lg px-5 py-3">
                                {% if cta.button_1_icon %}<i class="{{ cta.button_1_icon }} me-2"></i>{% endif %}{{ cta.button_1_text }}
                            </a>
                            {% if cta.button_2_text %}
                                <a href="{{ cta.button_2_url }}" class="btn btn-outline-light btn-lg px-5 py-3">
                                    {% if cta.button_2_icon %}<i class="{{ cta.button_2_icon }} me-2"></i>{% endif %}{{ cta.button_2_text }}
                                </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </section>
    {% else %}
        <!-- Default CTA if no CMS content exists -->
        <section class="section-padding text-white" style="background: linear-gradient(135deg, var(--primary-accent), var(--dark-accent));">
            <div class="container text-center">
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <h2 class="display-5 fw-bold mb-4" data-aos="fade-up">Join the AKILIMO Movement</h2>
                        <p class="lead mb-4" data-aos="fade-up" data-aos-delay="100">
                            Access evidence-based, site-specific recommendations validated by 5,000+ farmers. Start optimizing your productivity and profits today.
                        </p>
                        <div class="d-flex flex-wrap justify-content-center gap-3" data-aos="fade-up" data-aos-delay="200">
                            <a href="{% url 'website:register_redirect' %}" class="btn btn-light btn-lg px-5 py-3">
                                <i class="bi bi-person-plus me-2"></i>Join ANA
                            </a>
                            <a href="{% url 'website:contact' %}" class="btn btn-outline-light btn-lg px-5 py-3">
                                <i class="bi bi-envelope me-2"></i>Contact Us
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    {% endif %}
{% endblock %}

{% block extra_js %}
<script>
// Auto-refresh statistics from the API
(function() {
    const REFRESH_INTERVAL = 5 * 60 * 1000; // 5 minutes
    const API_URL = "{% url 'website:live_statistics' %}";

    function updateStatistics() {
        fetch(API_URL)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                if (data.success && data.statistics) {
                    const statsContainer = document.querySelector('.section-padding .row.text-center');
                    if (!statsContainer) return;

                    // Clear existing statistics
                    statsContainer.innerHTML = '';

                    // Add new statistics with animation
                    data.statistics.forEach((stat, index) => {
                        const delay = (index + 1) * 100;
                        const statCard = `
                            <div class="col-lg-3 col-md-6 mb-4" data-aos="fade-up" data-aos-delay="${delay}">
                                <div class="stat-card">
                                    <div class="mb-3">
                                        <i class="${stat.icon} display-4" style="color: var(--primary-accent);"></i>
                                    </div>
                                    <div class="stat-number">${stat.value}</div>
                                    <div class="stat-label">${stat.label}</div>
                                    ${stat.description ? `<small class="text-muted">${stat.description}</small>` : ''}
                                </div>
                            </div>
                        `;
                        statsContainer.insertAdjacentHTML('beforeend', statCard);
                    });

                    // Refresh AOS animations if available
                    if (typeof AOS !== 'undefined') {
                        AOS.refresh();
                    }

                    console.log('Statistics updated successfully');
                }
            })
            .catch(error => {
                console.error('Error fetching statistics:', error);
            });
    }

    // Initial update after page load (optional - comment out if you only want scheduled updates)
    // setTimeout(updateStatistics, 2000);

    // Set up periodic updates
    setInterval(updateStatistics, REFRESH_INTERVAL);

    console.log(`Statistics auto-refresh enabled (every ${REFRESH_INTERVAL / 60000} minutes)`);
})();
</script>
{% endblock %}